import{encodeData as k,entries as $,Logger as he,ensureEndingSlash as ke,isModuleAvailable as be,isDef as $e,isPlainObject as C,keys as M,endsWith as x,deepAssign as T,fromEntries as D,getModulePath as ve,addViteSsrNoExternal as Pe,addViteOptimizeDepsExclude as I,addViteSsrExternal as v,addViteOptimizeDepsInclude as O,addViteOptimizeDepsNeedsInterop as we,chainWebpack as Ce,isArray as je}from"@vuepress/helper";import{useSassPalettePlugin as Se}from"@vuepress/plugin-sass-palette";import{hash as Me,getDirname as xe,path as _e,colors as P,logger as De}from"vuepress/utils";import{createConverter as Ie}from"vuepress-shared/node";import{container as _}from"@mdit/plugin-container";import{demo as Oe}from"@mdit/plugin-demo";import{uml as Re}from"@mdit/plugin-uml";import{plantuml as Ee}from"@mdit/plugin-plantuml";const z=e=>{_(e,{name:"chartjs",openRender:(n,t)=>{const a=n[t].info.trimStart().slice(7).trim(),s=`chartjs-${t}`;let o="{}",r="";for(let i=t;i<n.length;i++){const{type:l,content:g,info:d}=n[i];if(l==="container_chartjs_close")break;g&&(l==="fence"&&(d==="json"?(o=k(g),r="json"):(d==="js"||d==="javascript")&&(o=k(g),r="js")),n[i].type="chartjs_empty",n[i].hidden=!0)}return`<ChartJS id="${s}" config="${o}" ${a?`title="${encodeURIComponent(a)}" `:""}type="${r}">`},closeRender:()=>"</ChartJS>"})},R=e=>e.replace(/&/gu,"&amp;").replace(/</gu,"&lt;").replace(/>/gu,"&gt;").replace(/"/gu,"&quot;").replace(/'/gu,"&#39;"),F={useBabel:!1,jsLib:[],cssLib:[],codepenLayout:"left",codepenEditors:"101",babel:"https://unpkg.com/@babel/standalone/babel.min.js",vue:"https://unpkg.com/vue/dist/vue.global.prod.js",react:"https://unpkg.com/react/umd/react.production.min.js",reactDOM:"https://unpkg.com/react-dom/umd/react-dom.production.min.js"},E=e=>n=>{_(n,{name:e,openRender:(t,a)=>{const s=t[a].info.trimStart().slice(e.length).trim();let o="";const r={};for(let i=a;i<t.length;i++){const{type:l,content:g,info:d}=t[i],c=d?/^([^ :[{]+)/.exec(n.utils.unescapeAll(d).trim())?.[1]??"text":"";if(l===`container_${e}_close`)break;g&&l==="fence"&&(c==="json"?o=k(g):r[c]=g)}return`<CodeDemo id="code-demo-${a}" type="${e.split("-")[0]}"${s?` title="${encodeURIComponent(s)}"`:""}${o?` config="${o}"`:""} code="${k(JSON.stringify(r))}">
`},closeRender:()=>`</CodeDemo>
`})},J=E("normal-demo"),L=E("vue-demo"),V=E("react-demo"),G=e=>{e.use(Oe,{name:"md-demo",openRender:(n,t)=>`<MdDemo title="${R(n[t].info)}" id="md-demo-${t}">
`,codeRender:(n,t,a,s,o)=>{const r=n[t];return r.type="fence",r.info="md",r.markup="```",r.content=r.content.split(`
`).filter(i=>!i.startsWith("@")||!/^@include-p(?:ush\(.*\)|op)$/.test(i)).join(`
`),`<template #code>
${o.rules.fence(n,t,a,s,o)}</template>
`},contentOpenRender:()=>`<template #default>
`,contentCloseRender:()=>`</template>
`,closeRender:()=>`</MdDemo>
`})},q=(e,n)=>{const t=e[n],a=`echarts-${n}`,{content:s,info:o}=t,r=o.trim().split(":",2)[1];return`<ECharts id="${a}" config="${k(s)}"${r?` title="${encodeURIComponent(r)}"`:""}></ECharts>`},B=e=>{const{fence:n}=e.renderer.rules;e.renderer.rules.fence=(...t)=>{const[a,s]=t,{info:o}=a[s];return o.split(":",2)[0]==="echarts"?q(a,s):n(...t)},e.renderer.rules.echarts=q,_(e,{name:"echarts",openRender:(t,a)=>{const s=t[a].info.trimStart().slice(7).trim(),o=`echarts-${a}`;let r="{}",i=!1;for(let l=a;l<t.length;l++){const{type:g,content:d,info:c}=t[l];if(g==="container_echarts_close")break;d&&(g==="fence"&&(c==="json"?r=d:(c==="js"||c==="javascript")&&(r=d,i=!0)),t[l].type="echarts_empty",t[l].hidden=!0)}return`<ECharts id="${o}" config="${k(r)}"${s?` title="${encodeURIComponent(s)}"`:""}${i?' type="js"':""}>`},closeRender:()=>"</ECharts>"})},Ue=["ant","pie","vue"],K=(e,n)=>{const t=e[n],a=`flowchart-${n}`,{content:s,info:o}=t,r=o.trim().split(":",2)[1];return`<FlowChart id="${a}" code="${k(s)}" preset="${Ue.includes(r)?r:"vue"}"></FlowChart>`},W=e=>{const{fence:n}=e.renderer.rules;e.renderer.rules.fence=(...t)=>{const[a,s]=t,{info:o}=a[s],[r]=o.split(":",2);return r==="flow"||r==="flowchart"?K(a,s):n(...t)},e.renderer.rules.flowchart=K},H="@",Ae=["file","import","setting"],Ne=e=>(n,t,a,s)=>{let o=n.bMarks[t]+n.tShift[t],r=n.eMarks[t];if(n.src[o]!==":")return!1;let i=o+1;for(;i<=r&&n.src[i]===":";)i+=1;const l=i-o;if(l<3)return!1;const g=n.src.slice(o,i),d=n.src.slice(i,r),c=d.trimStart().split(" ",2)[0],y=d.trimStart().slice(e.length).trim();if(c.trim()!==e)return!1;if(s)return!0;let m=t,u=!1;for(;m<a&&(m+=1,o=n.bMarks[m]+n.tShift[m],r=n.eMarks[m],!(o<r&&n.sCount[m]<n.blkIndent));)if(n.src[o]===":"&&n.sCount[m]-n.blkIndent<4){for(i=o+1;i<=r&&n.src[i]===":";i++);if(i-o>=l&&(i=n.skipSpaces(i),i>=r)){u=!0;break}}const p=n.parentType,f=n.lineMax;n.parentType=e,n.lineMax=m-(u?1:0);const h=n.push(`${e}_open`,"template",1);h.markup=g,h.block=!0,h.info=y,h.map=[t,m-(u?1:0)],n.md.block.tokenize(n,t+1,m-(u?1:0));const S=n.push(`${e}_close`,"template",-1);return S.markup=n.src.slice(o,i),S.block=!0,n.parentType=p,n.lineMax=f,n.line=m+(u?1:0),!0},Te=e=>(n,t,a,s)=>{let o=n.bMarks[t]+n.tShift[t],r=n.eMarks[t];const i=`${H}${e}`;if(n.src.charAt(o)!=="@")return!1;let l;for(l=0;l<i.length;l++)if(i[l]!==n.src[o+l])return!1;const g=n.src.slice(o,o+l),d=n.src.slice(o+l,r);if(s)return!0;let c=t,y=!1;for(;c<a&&(c+=1,o=n.bMarks[c]+n.tShift[c],r=n.eMarks[c],!(o<r&&n.sCount[c]<n.blkIndent));)if(n.src[o]===H&&n.sCount[c]<=n.sCount[t]){let h=!0;for(l=0;l<i.length;l++)if(i[l]!==n.src[o+l]){h=!1;break}if(h){y=!0,c-=1;break}}const m=n.parentType,u=n.lineMax;n.parentType=e,n.lineMax=c;const p=n.push(`${e}_open`,"template",1);p.block=!0,p.markup=g,p.info=d.trim(),p.map=[t,c],n.md.block.tokenize(n,t+1,c);const f=n.push(`${e}_close`,"template",-1);return f.block=!0,f.markup="",n.parentType=m,n.lineMax=u,n.line=c+(y?1:0),!0},Y=e=>({key:e.key,title:e.title??"",files:encodeURIComponent(JSON.stringify(e.files)),settings:encodeURIComponent(JSON.stringify(e.settings))}),j=(e,{name:n="playground",component:t="Playground",propsGetter:a=Y}={name:"playground",component:"Playground",propsGetter:Y})=>{e.block.ruler.before("fence",n,Ne(n),{alt:["paragraph","reference","blockquote","list"]}),Ae.forEach(s=>{e.block.ruler.__rules__.find(({name:o})=>o===`at-${s}`)||e.block.ruler.before("fence",`at-${s}`,Te(s),{alt:["paragraph","reference","blockquote","list"]})}),e.renderer.rules[`${n}_open`]=(s,o)=>{const{info:r}=s[o],i={key:Me(`playground${o}-${r}`),title:encodeURIComponent(r),settings:{},files:{}};let l=null,g=!1;for(let c=o;c<s.length;c++){const{block:y,type:m,info:u,content:p}=s[c];if(y){if(m===`${n}_close`)break;if(m===`${n}_open`)continue;if(m==="file_open"){if(!u)continue;l=u}else if(m==="import_open")i.importMap=l=u||"import-map.json";else if(m==="setting_open")g=!0;else if(m==="file_close"||m==="import_close"||m==="setting_close"||!p){s[c].type=`${n}_empty`,s[c].hidden=!0,m==="setting_close"&&(g=!1);continue}g?m==="fence"&&u==="json"&&(i.settings=JSON.parse(p.trim())):m==="fence"&&l&&(i.files[l]={ext:u,content:p}),s[c].type=`${n}_empty`,s[c].hidden=!0}}const d=a(i);return`<${t} ${$(d).map(([c,y])=>`${c}="${R(y)}"`).join(" ")}>
`},e.renderer.rules[`${n}_close`]=()=>`</${t}>
`},ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",Fe=(e,n,t)=>{let a,s,o,r={},i={},l="",g="",d="",c=2,y=3,m=2,u=[],p=0,f=0;for(o=0;o<e.length;o+=1)if(l=e.charAt(o),Object.prototype.hasOwnProperty.call(r,l)||(r[l]=y++,i[l]=!0),g=d+l,Object.prototype.hasOwnProperty.call(r,g))d=g;else{if(Object.prototype.hasOwnProperty.call(i,d)){if(d.charCodeAt(0)<256){for(a=0;a<m;a++)p<<=1,f==n-1?(f=0,u.push(t(p)),p=0):f++;for(s=d.charCodeAt(0),a=0;a<8;a++)p=p<<1|1&s,f==n-1?(f=0,u.push(t(p)),p=0):f++,s>>=1}else{for(s=1,a=0;a<m;a++)p=p<<1|s,f==n-1?(f=0,u.push(t(p)),p=0):f++,s=0;for(s=g.charCodeAt(0),a=0;a<16;a++)p=p<<1|1&s,f==n-1?(f=0,u.push(t(p)),p=0):f++,s>>=1}--c==0&&(c=Math.pow(2,m),m++),delete i[d]}else for(s=r[d],a=0;a<m;a++)p=p<<1|1&s,f==n-1?(f=0,u.push(t(p)),p=0):f++,s>>=1;--c==0&&(c=Math.pow(2,m),m++),r[g]=y++,d=String(l)}if(d!==""){if(Object.prototype.hasOwnProperty.call(i,d)){if(d.charCodeAt(0)<256){for(a=0;a<m;a++)p<<=1,f==n-1?(f=0,u.push(t(p)),p=0):f++;for(s=d.charCodeAt(0),a=0;a<8;a++)p=p<<1|1&s,f==n-1?(f=0,u.push(t(p)),p=0):f++,s>>=1}else{for(s=1,a=0;a<m;a++)p=p<<1|s,f==n-1?(f=0,u.push(t(p)),p=0):f++,s=0;for(s=d.charCodeAt(0),a=0;a<16;a++)p=p<<1|1&s,f==n-1?(f=0,u.push(t(p)),p=0):f++,s>>=1}--c==0&&(c=Math.pow(2,m),m++),delete i[d]}else for(s=r[d],a=0;a<m;a++)p=p<<1|1&s,f==n-1?(f=0,u.push(t(p)),p=0):f++,s>>=1;--c==0&&(c=Math.pow(2,m),m++)}for(s=2,a=0;a<m;a++)p=p<<1|1&s,f==n-1?(f=0,u.push(t(p)),p=0):f++,s>>=1;for(;;){if(p<<=1,f==n-1){u.push(t(p));break}f++}return u.join("")},Q=e=>Fe(e,6,n=>ze.charAt(n)),Je=[{name:"help",type:"boolean"},{name:"help",type:"boolean"},{name:"watch",type:"boolean"},{name:"preserveWatchOutput",type:"boolean"},{name:"listFiles",type:"boolean"},{name:"explainFiles",type:"boolean"},{name:"listEmittedFiles",type:"boolean"},{name:"pretty",type:"boolean"},{name:"traceResolution",type:"boolean"},{name:"diagnostics",type:"boolean"},{name:"extendedDiagnostics",type:"boolean"},{name:"generateCpuProfile",type:"string"},{name:"generateTrace",type:"string"},{name:"incremental",type:"boolean"},{name:"declaration",type:"boolean"},{name:"declarationMap",type:"boolean"},{name:"emitDeclarationOnly",type:"boolean"},{name:"sourceMap",type:"boolean"},{name:"inlineSourceMap",type:"boolean"},{name:"noCheck",type:"boolean"},{name:"noEmit",type:"boolean"},{name:"assumeChangesOnlyAffectDirectDependencies",type:"boolean"},{name:"locale",type:"string"},{name:"all",type:"boolean"},{name:"version",type:"boolean"},{name:"init",type:"boolean"},{name:"project",type:"string"},{name:"showConfig",type:"boolean"},{name:"listFilesOnly",type:"boolean"},{name:"target",type:{es3:0,es5:1,es6:2,es2015:2,es2016:3,es2017:4,es2018:5,es2019:6,es2020:7,es2021:8,es2022:9,es2023:10,es2024:11,esnext:99}},{name:"module",type:{none:0,commonjs:1,amd:2,system:4,umd:3,es6:5,es2015:5,es2020:6,es2022:7,esnext:99,node16:100,nodenext:199,preserve:200}},{name:"lib",type:"list"},{name:"allowJs",type:"boolean"},{name:"checkJs",type:"boolean"},{name:"jsx",type:{preserve:1,"react-native":3,react:2,"react-jsx":4,"react-jsxdev":5}},{name:"outFile",type:"string"},{name:"outDir",type:"string"},{name:"rootDir",type:"string"},{name:"composite",type:"boolean"},{name:"tsBuildInfoFile",type:"string"},{name:"removeComments",type:"boolean"},{name:"importHelpers",type:"boolean"},{name:"importsNotUsedAsValues",type:{remove:0,preserve:1,error:2}},{name:"downlevelIteration",type:"boolean"},{name:"isolatedModules",type:"boolean"},{name:"verbatimModuleSyntax",type:"boolean"},{name:"isolatedDeclarations",type:"boolean"},{name:"strict",type:"boolean"},{name:"noImplicitAny",type:"boolean"},{name:"strictNullChecks",type:"boolean"},{name:"strictFunctionTypes",type:"boolean"},{name:"strictBindCallApply",type:"boolean"},{name:"strictPropertyInitialization",type:"boolean"},{name:"strictBuiltinIteratorReturn",type:"boolean"},{name:"noImplicitThis",type:"boolean"},{name:"useUnknownInCatchVariables",type:"boolean"},{name:"alwaysStrict",type:"boolean"},{name:"noUnusedLocals",type:"boolean"},{name:"noUnusedParameters",type:"boolean"},{name:"exactOptionalPropertyTypes",type:"boolean"},{name:"noImplicitReturns",type:"boolean"},{name:"noFallthroughCasesInSwitch",type:"boolean"},{name:"noUncheckedIndexedAccess",type:"boolean"},{name:"noImplicitOverride",type:"boolean"},{name:"noPropertyAccessFromIndexSignature",type:"boolean"},{name:"moduleResolution",type:{node10:2,node:2,classic:1,node16:3,nodenext:99,bundler:100}},{name:"baseUrl",type:"string"},{name:"paths",type:"object"},{name:"rootDirs",type:"list"},{name:"typeRoots",type:"list"},{name:"types",type:"list"},{name:"allowSyntheticDefaultImports",type:"boolean"},{name:"esModuleInterop",type:"boolean"},{name:"preserveSymlinks",type:"boolean"},{name:"allowUmdGlobalAccess",type:"boolean"},{name:"moduleSuffixes",type:"list"},{name:"allowImportingTsExtensions",type:"boolean"},{name:"rewriteRelativeImportExtensions",type:"boolean"},{name:"resolvePackageJsonExports",type:"boolean"},{name:"resolvePackageJsonImports",type:"boolean"},{name:"customConditions",type:"list"},{name:"noUncheckedSideEffectImports",type:"boolean"},{name:"sourceRoot",type:"string"},{name:"mapRoot",type:"string"},{name:"inlineSources",type:"boolean"},{name:"experimentalDecorators",type:"boolean"},{name:"emitDecoratorMetadata",type:"boolean"},{name:"jsxFactory",type:"string"},{name:"jsxFragmentFactory",type:"string"},{name:"jsxImportSource",type:"string"},{name:"resolveJsonModule",type:"boolean"},{name:"allowArbitraryExtensions",type:"boolean"},{name:"out",type:"string"},{name:"reactNamespace",type:"string"},{name:"skipDefaultLibCheck",type:"boolean"},{name:"charset",type:"string"},{name:"emitBOM",type:"boolean"},{name:"newLine",type:{crlf:0,lf:1}},{name:"noErrorTruncation",type:"boolean"},{name:"noLib",type:"boolean"},{name:"noResolve",type:"boolean"},{name:"stripInternal",type:"boolean"},{name:"disableSizeLimit",type:"boolean"},{name:"disableSourceOfProjectReferenceRedirect",type:"boolean"},{name:"disableSolutionSearching",type:"boolean"},{name:"disableReferencedProjectLoad",type:"boolean"},{name:"noImplicitUseStrict",type:"boolean"},{name:"noEmitHelpers",type:"boolean"},{name:"noEmitOnError",type:"boolean"},{name:"preserveConstEnums",type:"boolean"},{name:"declarationDir",type:"string"},{name:"skipLibCheck",type:"boolean"},{name:"allowUnusedLabels",type:"boolean"},{name:"allowUnreachableCode",type:"boolean"},{name:"suppressExcessPropertyErrors",type:"boolean"},{name:"suppressImplicitAnyIndexErrors",type:"boolean"},{name:"forceConsistentCasingInFileNames",type:"boolean"},{name:"maxNodeModuleJsDepth",type:"number"},{name:"noStrictGenericChecks",type:"boolean"},{name:"useDefineForClassFields",type:"boolean"},{name:"preserveValueImports",type:"boolean"},{name:"keyofStringsOnly",type:"boolean"},{name:"plugins",type:"list"},{name:"moduleDetection",type:{auto:2,legacy:1,force:3}},{name:"ignoreDeprecations",type:"string"}],Le=xe(import.meta.url),X="vuepress-plugin-md-enhance",w=new he(X),b=ke(_e.resolve(Le,"../client")),Ve=(e,n=!0)=>{const t=be(e,import.meta);return n&&!t&&w.error(`Package ${e} is not installed, please install it manually!`),t},Z=(e,n={})=>{const t=`#code/${Q(e)}`,a=$(n).map(([s,o])=>{const r=Je.find(l=>l.name===s);if(!r||o===null||!$e(o))return"";const{type:i}=r;return C(i)?i[o]?.toString()??"":`${s}=${encodeURIComponent(o)}`}).filter(s=>s.length).join("&");return`${a?`?${a}`:""}${t}`},ee=({service:e="https://www.typescriptlang.org/play",...n}={})=>({name:"playground#ts",propsGetter:({title:t="",files:a,settings:s})=>{const o=M(a).filter(i=>x(i,".ts"));o.length!==1&&w.error("TS playground only support 1 ts file");const r=`${e}${Z(a[o[0]].content,T({},s,n))}`;return{title:t,link:encodeURIComponent(r)}}}),Ge=["html","js","ts","vue","jsx","tsx","json"],ne="https://sfc.vuejs.org/vue.runtime.esm-browser.js",te="https://sfc.vuejs.org/server-renderer.esm-browser.js",oe=(e={})=>({name:"playground#vue",propsGetter:n=>{const{title:t="",files:a,settings:s}=n,o={service:"https://sfc.vuejs.org/",dev:!1,ssr:!1,...e,...s},r=D($(a).filter(([,{ext:i}])=>Ge.includes(i)).map(([i,{content:l}])=>{if(i==="import-map.json"){const g=JSON.parse(l);return[i,JSON.stringify(T({imports:{vue:ne,...o.ssr?{"vue/server-renderer":te}:{}}},g),null,2)]}return[i,l]}));return o.ssr&&!r["import-map.json"]&&(r["import-map.json"]=JSON.stringify({imports:{vue:ne,"vue/server-renderer":te}},null,2)),{title:t,link:encodeURIComponent(`${o.service}#${o.dev?"__DEV__":""}${o.ssr?"__SSR__":""}${Buffer.from(JSON.stringify(r)).toString("base64")}`)}}}),U=(e,n,t="&")=>n?`${t}${e}=${Q(n)}`:"",se=(e,n,t,a)=>{const s=`/${U("html",n,"?")}${U("config",a)}${U("css",t)}`;return`${e}${s}`},ae=({service:e="https://unocss.dev/play"}={})=>({name:"playground#unocss",propsGetter:({title:n="",files:t})=>{const a=M(t).filter(l=>x(l,".html")),s=M(t).filter(l=>x(l,".css")),o=M(t).filter(l=>x(l,".js")||x(l,".ts"));(a.length>1||s.length>1||o.length>1)&&w.error("UnoCSS playground only support 1 html/css/config file");const r=l=>l.length===1?t[l[0]].content:"",i=se(e,r(a),r(s),r(o));return{title:n,link:encodeURIComponent(i)}}}),re=e=>{e.use(j,{name:"kotlin-playground",component:"KotlinPlayground",propsGetter:({title:n="",key:t,files:a,settings:s})=>({title:n,key:t,settings:encodeURIComponent(JSON.stringify(s)),files:k(JSON.stringify($(a).map(([,{content:o}])=>o)))})})},ie=(e,n)=>{const t=e[n],a=`markmap-${n}`,{content:s}=t;return`<MarkMap id="${a}" content="${k(s)}"></MarkMap>`},le=e=>{const{fence:n}=e.renderer.rules;e.renderer.rules.fence=(...t)=>{const[a,s]=t,{info:o}=a[s],[r]=o.split(":",2);return r==="markmap"?ie(a,s):n(...t)},e.renderer.rules.markmap=ie},qe=(e,n)=>`<Mermaid id="mermaid-${n}" code="${k(e[n].content)}"></Mermaid>`,pe=({diagram:e="mermaid",content:n,title:t="",indent:a=e!=="mermaid"})=>`${t?`---
title: ${t}
---

`:""}${e==="mermaid"?"":`${e}
`}${a?n.split(`
`).map(s=>s?`  ${s}`:"").join(`
`):n}`,me=(e,n)=>`<Mermaid id="mermaid-${n}" code="${k(pe(e))}"${e.title?` title="${k(e.title)}"`:""}></Mermaid>`,A={class:["classDiagram"],c4c:["C4Context"],er:["erDiagram"],gantt:[""],"git-graph":["gitGraph"],journey:[""],mindmap:[""],kanban:[""],pie:[""],quadrant:["quadrantChart"],requirement:["requirementDiagram"],sequence:["sequenceDiagram"],state:["stateDiagram-v2"],timeline:[""],architecture:["architecture-beta"],block:["block-beta",!1],packet:["packet-beta",!1],sankey:["sankey-beta",!1],xy:["xychart-beta",!1]},ce=e=>{const{fence:n}=e.renderer.rules;e.renderer.rules.fence=(...t)=>{const[a,s]=t,{content:o,info:r}=a[s],i=r.trim();if(i==="mermaid")return me({content:o,indent:!1},s);const[l,...g]=i.split(" ");return l in A?me({diagram:A[l][0]||l,title:g.join(" "),content:o,indent:A[l][1]??!0},s):n(...t)},e.renderer.rules.mermaid=qe},N=(e,n=["chronology","gantt","json","latex","math","mindmap","regex","salt","uml","wbs","yaml"].map(t=>({name:t})))=>{n.forEach(t=>{e.use(Ee,t)})},Be=["html","js","ts","vue","jsx","tsx","json"],Ke=e=>Buffer.from(JSON.stringify(D($(e).filter(([,{ext:n}])=>Be.includes(n)).map(([n,{content:t}])=>[n,t])))).toString("base64"),de=e=>{e.use(j,{name:"vue-playground",component:"VuePlayground",propsGetter:({title:n="",key:t,files:a,settings:s})=>({title:n,key:t,settings:encodeURIComponent(JSON.stringify(s)),files:encodeURIComponent(Ke(a))})})},We=e=>JSON.stringify(D($(e).map(([n,t])=>[n,typeof t=="string"||t.active||t.hidden||t.readOnly?t:t.code]))),ue=e=>{const n=/.*(?<!\\)\[([^}]*)\].*/.exec(e);if(n?.[1]){const t=n[1].split(" ");return D(t.filter(a=>a.trim().length>0).map(a=>{const[s,o=""]=a.trim().split("=",2);return[s,o]}))}return{}},fe="@",He=["file","options","setup"],Ye=e=>({title:e.title??"",template:e.template??"",files:k(We(e.files)),options:k(JSON.stringify(e.options??{})),customSetup:k(JSON.stringify(e.customSetup??{}))}),ge=e=>new Function(`return ${e};`)(),Qe=(e,n,t,a)=>{let s=e.bMarks[n]+e.tShift[n],o=e.eMarks[n];if(e.src[s]!==":")return!1;let r=s+1;for(;r<=o&&e.src[r]===":";)r+=1;const i=r-s;if(i<3)return!1;const l=e.src.slice(s,r),g=e.src.slice(r,o).trim(),d=g.indexOf(" ");let c="",y="";if(d>0?(c=g.substring(0,d),y=g.substring(d+1).replace(/(?<!\\)\[([^}]*)\]/g,"")):c=g,!c.startsWith("sandpack"))return!1;if(a)return!0;let m=n,u=!1;for(;m<t&&(m+=1,s=e.bMarks[m]+e.tShift[m],o=e.eMarks[m],!(s<o&&e.sCount[m]<e.blkIndent));)if(e.src[s]===":"&&e.sCount[m]-e.blkIndent<4){for(r=s+1;r<=o&&e.src[r]===":";r++);if(r-s>=i&&(r=e.skipSpaces(r),r>=o)){u=!0;break}}const p=e.parentType,f=e.lineMax;e.parentType="sandpack",e.lineMax=m-(u?1:0);const h=e.push("sandpack_open","template",1);h.markup=l,h.content=g,h.block=!0,h.info=y,h.map=[n,m-(u?1:0)],e.md.block.tokenize(e,n+1,m-(u?1:0));const S=e.push("sandpack_close","template",-1);return S.markup=e.src.slice(s,r),S.block=!0,e.parentType=p,e.lineMax=f,e.line=m+(u?1:0),!0},Xe=e=>(n,t,a,s)=>{let o=n.bMarks[t]+n.tShift[t],r=n.eMarks[t];const i=`${fe}${e}`;if(n.src.charAt(o)!=="@")return!1;let l;for(l=0;l<i.length;l++)if(i[l]!==n.src[o+l])return!1;const g=n.src.slice(o,o+l),d=n.src.slice(o+l,r);if(s)return!0;let c=t,y=!1;for(;c<a&&(c+=1,o=n.bMarks[c]+n.tShift[c],r=n.eMarks[c],!(o<r&&n.sCount[c]<n.blkIndent));)if(n.src[o]===fe&&n.sCount[c]<=n.sCount[t]){let h=!0;for(l=0;l<i.length;l++)if(i[l]!==n.src[o+l]){h=!1;break}if(h){y=!0,c-=1;break}}const m=n.parentType,u=n.lineMax;n.parentType=e,n.lineMax=c;const p=n.push(`${e}_open`,"template",1);p.block=!0,p.markup=g,p.info=d.trim(),p.map=[t,c],n.md.block.tokenize(n,t+1,c);const f=n.push(`${e}_close`,"template",-1);return f.block=!0,f.markup="",n.parentType=m,n.lineMax=u,n.line=c+(y?1:0),!0},ye=e=>{e.block.ruler.before("fence","sandpack",Qe,{alt:["paragraph","reference","blockquote","list"]}),He.forEach(n=>{e.block.ruler.__rules__.find(({name:t})=>t===`at-${n}`)||e.block.ruler.before("fence",`at-${n}`,Xe(n),{alt:["paragraph","reference","blockquote","list"]})}),e.renderer.rules.sandpack_open=(n,t)=>{const{content:a,info:s}=n[t],o=ue(a),r={title:encodeURIComponent(s),files:{},options:{},customSetup:{}},i=a.split(" ",2)[0].trim().split("#");i.length>1&&(r.template=i[1]);let l=null,g=!1,d=!1;for(let y=t;y<n.length;y++){const{block:m,type:u,info:p,content:f}=n[y];if(m){if(u==="sandpack_close")break;if(u==="sandpack_open")continue;if(u==="file_open"){if(!p)continue;l=p.trim().split(" ")[0];const h=ue(p);r.files[l]={code:"",active:"active"in h,hidden:"hidden"in h,readOnly:"readOnly"in h}}else(u==="file_close"||u==="setup_open"||u==="options_open")&&(l=null);if(u==="setup_open"?d=!0:u==="setup_close"?d=!1:u==="options_open"?g=!0:u==="options_close"&&(g=!1),u==="file_close"||u==="setup_close"||u==="options_close"||!f){n[y].type="sandpack_empty",n[y].hidden=!0;continue}g&&(u==="fence"&&(p==="js"||p==="javascript")&&(r.options=ge(f.trim())),g=!1),d&&(u==="fence"&&(p==="js"||p==="javascript")&&(r.customSetup=ge(f.trim())),d=!1),u==="fence"&&l&&(r.files[l].code=f),n[y].type="sandpack_empty",n[y].hidden=!0}}const c=Ye(r);return`<SandPack ${M(o).length?`${$(o).map(([y,m])=>m?`${y}="${R(m)}"`:y).join(" ")} `:""}${$(c).map(([y,m])=>m?`${y}="${R(m)}"`:null).filter(Boolean).join(" ")}>
`},e.renderer.rules.sandpack_close=()=>`</SandPack>
`},Ze=e=>{_(e,{name:"chart",openRender:(n,t)=>{console.warn("chart container is deprecated, use chartjs container instead.");const a=n[t].info.trimStart().slice(5).trim(),s=`chart-${t}`;let o="{}",r="";for(let i=t;i<n.length;i++){const{type:l,content:g,info:d}=n[i];if(l==="container_chart_close")break;g&&(l==="fence"&&(d==="json"?(o=k(g),r="json"):(d==="js"||d==="javascript")&&(o=k(g),r="js")),n[i].type="chart_empty",n[i].hidden=!0)}return`<ChartJS id="${s}" config="${o}" ${a?`title="${encodeURIComponent(a)}" `:""}type="${r}">`},closeRender:()=>"</ChartJS>"})},en=e=>{const{deprecatedLogger:n,droppedLogger:t}=Ie("md-enhance");n({options:e,old:"chart",new:"chartjs"}),t({options:e,old:"enableAll",msg:"Please manually enable the features you need."}),t({options:e,old:"imageFix",msg:"This option is no longer needed."}),t({options:e,old:"lineNumbers",msg:"Please use lineNumbers option in @vuepress/plugin-prismjs or @vuepress/plugin-shiki !"}),t({options:e,old:"alert",msg:"Please use alert option in @vuepress/plugin-markdown-hint instead."}),t({options:e,old:"container",msg:"Please use hint option in @vuepress/plugin-markdown-hint instead."}),t({options:e,old:"hint",msg:"Please use hint option in @vuepress/plugin-markdown-hint instead."}),t({options:e,old:"mdImport",msg:"Please use @vuepress/plugin-markdown-include instead."}),t({options:e,old:"include",msg:"Please use @vuepress/plugin-markdown-include instead."}),t({options:e,old:"imageTitle",msg:"Please use figure option in @vuepress/plugin-markdown-image instead."}),t({options:e,old:"figure",msg:"Please use figure option in @vuepress/plugin-markdown-image instead."}),t({options:e,old:"imageMark",msg:"Please use mark option in @vuepress/plugin-markdown-image instead."}),t({options:e,old:"imgMark",msg:"Please use mark option in @vuepress/plugin-markdown-image instead."}),t({options:e,old:"imgSize",msg:"Please use size option in @vuepress/plugin-markdown-image instead."}),t({options:e,old:"imageSize",msg:"Please use size option in @vuepress/plugin-markdown-image instead."}),t({options:e,old:"lazyload",msg:"Please use lazyload option in @vuepress/plugin-markdown-image instead."}),t({options:e,old:"imageLazyload",msg:"Please use lazyload option in @vuepress/plugin-markdown-image instead."}),t({options:e,old:"imgLazyload",msg:"Please use lazyload option in @vuepress/plugin-markdown-image instead."}),t({options:e,old:"obsidianImgSize",msg:"Please use obsidianSize option in @vuepress/plugin-markdown-image instead."}),t({options:e,old:"linkCheck",msg:"Please use @vuepress/plugin-links-check instead."}),t({options:e,old:"checkLinks",msg:"Please use @vuepress/plugin-links-check instead."}),t({options:e,old:"tex",msg:"Please use @vuepress/plugin-markdown-math instead."}),t({options:e,old:"katex",msg:"Please use @vuepress/plugin-markdown-math instead."}),t({options:e,old:"mathjax",msg:"Please use @vuepress/plugin-markdown-math instead."}),t({options:e,old:"revealjs",msg:"Please use @vuepress/plugin-revealjs instead."}),t({options:e,old:"revealJs",msg:"Please use @vuepress/plugin-revealjs instead."}),t({options:e,old:"presentation",msg:"Please use @vuepress/plugin-revealjs instead."}),t({options:e,old:"codegroup",msg:"Please use codeTabs option in @vuepress/plugin-markdown-tab instead."}),t({options:e,old:"codetabs",msg:"Please use codeTabs option in @vuepress/plugin-markdown-tab instead."}),t({options:e,old:"tabs",msg:"Please use tabs option in @vuepress/plugin-markdown-tab instead."}),t({options:e,old:"vpre",msg:"Please use vPre option in @vuepress/plugin-markdown-ext instead."}),t({options:e,old:"vPre",msg:"Please use vPre option in @vuepress/plugin-markdown-ext instead."}),t({options:e,old:"breaks",msg:"Please use breaks option in @vuepress/plugin-markdown-ext instead."}),t({options:e,old:"linkify",msg:"Please use linkify option in @vuepress/plugin-markdown-ext instead."}),t({options:e,old:"gfm",msg:"Please use gfm option in @vuepress/plugin-markdown-ext instead."}),t({options:e,old:"footnote",msg:"Please use footnote option in @vuepress/plugin-markdown-ext instead."}),t({options:e,old:"tasklist",msg:"Please use tasklist option in @vuepress/plugin-markdown-ext instead."}),t({options:e,old:"component",msg:"Please use component option in @vuepress/plugin-markdown-ext instead."}),t({options:e,old:"align",msg:"Please use align option in @vuepress/plugin-markdown-stylize instead."}),t({options:e,old:"attrs",msg:"Please use attrs option in @vuepress/plugin-markdown-stylize instead."}),t({options:e,old:"mark",msg:"Please use mark option in @vuepress/plugin-markdown-stylize instead."}),t({options:e,old:"spoiler",msg:"Please use spoiler option in @vuepress/plugin-markdown-stylize instead."}),t({options:e,old:"sub",msg:"Please use sub option in @vuepress/plugin-markdown-stylize instead."}),t({options:e,old:"sup",msg:"Please use sup option in @vuepress/plugin-markdown-stylize instead."}),t({options:e,old:"stylize",msg:"Please use custom option in @vuepress/plugin-markdown-stylize instead."}),e.card&&w.error(`${P.magenta("card")} is deprecated, please import  ${P.magenta("VPCard")} from "vuepress-plugin-components" and use it instead.`),C(e.mermaid)&&(w.error(`Customizing mermaid with option ${P.magenta("mermaid")} is no longer supported, please import and use ${P.magenta("defineMermaidConfig")} from ${P.magenta("vuepress-plugin-md-enhance/client")} instead.`),e.mermaid=!0),C(e.vuePlayground)&&(w.error(`Customizing @vue/repl with option ${P.magenta("vuePlayground")} is no longer supported, please import and use ${P.magenta("defineVuePlaygroundConfig")} from ${P.magenta("vuepress-plugin-md-enhance/client")} instead.`),e.vuePlayground=!0)},nn=e=>{e.use(_,{name:"demo",openRender:(n,t)=>{w.warn("demo container is deprecated, you should use normal-demo, react-demo and vue-demo container instead.");const{info:a}=n[t],s=/\[(.*)\]/u.exec(a),o=/^ demo\s*(?:\[.*?\])?\s*(.*)\s*$/u.exec(a);let r="";const i={};for(let l=t;l<n.length;l++){const{type:g,content:d,info:c}=n[l],y=c?/^([^ :[{]+)/.exec(e.utils.unescapeAll(c).trim())?.[1]??"text":"";if(g==="container_demo_close")break;d&&g==="fence"&&(y==="json"?r=k(d):i[y]=d)}return`
<CodeDemo id="code-demo-${t}" type="${s?.[1]??"normal"}"${o?` title="${encodeURIComponent(o[1])}"`:""}${r?` config="${r}"`:""} code="${k(JSON.stringify(i))}">
`},closeRender:()=>"</CodeDemo>"})},tn=e=>{Re(e,{name:"flowchart",open:"flowstart",close:"flowend",render:(n,t)=>{De.warn('"@flowstart ... @flowend" is deprecated, you should use ```flow ... ``` instead.');const a=n[t],s=`flowchart-${t}`,{content:o,info:r}=a;return`<FlowChart id="${s}" code="${k(o)}" preset="${r.trim()||"vue"}"></FlowChart>`}})},on=async(e,n,t)=>{const a=new Set,s=new Set;return t.chartjs&&(a.add(`import ChartJS from "${b}components/ChartJS.js";`),s.add('app.component("ChartJS", ChartJS)')),n.demo&&(a.add(`import CodeDemo from "${b}components/CodeDemo.js";`),a.add(`import MdDemo from "${b}components/MdDemo.js";`),s.add('app.component("CodeDemo", CodeDemo);'),s.add('app.component("MdDemo", MdDemo);')),t.echarts&&(a.add(`import ECharts from "${b}components/ECharts.js";`),s.add('app.component("ECharts", ECharts);')),t.flowchart&&(a.add(`import FlowChart from "${b}components/FlowChart.js";`),s.add('app.component("FlowChart", FlowChart);')),t.kotlinPlayground&&(a.add(`import KotlinPlayground from "${b}components/KotlinPlayground.js";`),s.add('app.component("KotlinPlayground", KotlinPlayground);')),t.markmap&&(a.add(`import MarkMap from "${b}components/MarkMap.js";`),s.add('app.component("MarkMap", MarkMap);')),t.mermaid&&(a.add(`import Mermaid from "${b}components/Mermaid.js";`),s.add('app.component("Mermaid", Mermaid);')),n.playground&&(a.add(`import Playground from "${b}components/Playground.js";`),s.add('app.component("Playground", Playground);')),t.sandpack&&(a.add('import { defineAsyncComponent } from "vue";'),a.add(`import { LoadingIcon } from "${ve("@vuepress/helper/client",import.meta)}";`),s.add(`app.component(
  "SandPack",
  defineAsyncComponent({
    loader: () => import("${b}components/SandPack.js"),
    loadingComponent: LoadingIcon,
  })
);`)),t.vuePlayground&&(a.add(`import VuePlayground from "${b}components/VuePlayground.js";`),s.add('app.component("VuePlayground", VuePlayground);')),e.writeTemp("md-enhance/config.js",`${Array.from(a.values()).join(`
`)}

export default {
  enhance: ({ app }) => {
${Array.from(s.values()).map(o=>o.split(`
`).map(r=>`    ${r}`)).flat().join(`
`)}
  },
};
`)},sn=(e={},n=!0)=>t=>{n&&en(e),t.env.isDebug&&w.info("Options:",e);const a=(o,r=[])=>!!e[o]&&r.every(i=>Ve(i,!!e[o])),s={chartjs:a("chartjs",["chart.js"]),echarts:a("echarts",["echarts"]),flowchart:a("flowchart",["flowchart.ts"]),mark:a("mark"),markmap:a("markmap",["markmap-lib","markmap-toolbar","markmap-view"]),mermaid:a("mermaid",["mermaid"]),kotlinPlayground:a("kotlinPlayground",["kotlin-playground"]),sandpack:a("sandpack",["sandpack-vue3"]),vuePlayground:a("vuePlayground",["@vue/repl"])};return Se(t,{id:"hope"}),{name:X,define:()=>({MARKDOWN_ENHANCE_DELAY:e.delay??800,CODE_DEMO_OPTIONS:{...F,...C(e.demo)?e.demo:{}},VUE_PLAYGROUND_MONACO:C(e.vuePlayground)&&e.vuePlayground.editor==="monaco"}),extendsBundlerOptions:(o,r)=>{Pe(o,r,["@vuepress/helper","fflate","vuepress-shared"]),s.chartjs&&(I(o,r,"chart.js/auto/auto.mjs"),v(o,r,"chart.js")),s.echarts&&(I(o,r,"echarts"),v(o,r,"echarts")),s.flowchart&&(I(o,r,"flowchart.ts"),v(o,r,"flowchart.ts")),s.markmap&&(O(o,r,["markmap-lib","markmap-toolbar","markmap-view"]),v(o,r,["markmap-lib","markmap-toolbar","markmap-view"])),s.mermaid&&(I(o,r,"mermaid/dist/mermaid.esm.min.mjs"),v(o,r,"mermaid")),s.kotlinPlayground&&(O(o,r,"kotlin-playground"),we(o,r,"kotlin-playground"),v(o,r,"kotlin-playground")),s.sandpack&&(O(o,r,"sandpack-vue3"),v(o,r,"sandpack-vue3")),s.vuePlayground&&(O(o,r,"@vue/repl"),v(o,r,"@vue/repl"),Ce(o,r,i=>{i.resolve.set("conditionNames",["browser","import","module"]),i.module.set("exprContextCritical",!1),i.module.set("unknownContextCritical",!1)}))},extendsMarkdown:o=>{if(s.flowchart&&(o.use(W),n&&o.use(tn)),s.chartjs&&(o.use(z),n&&o.use(Ze)),s.echarts&&o.use(B),je(e.plantuml)?o.use(N,e.plantuml):e.plantuml&&o.use(N),e.demo&&(o.use(G),o.use(J),o.use(L),o.use(V),n&&o.use(nn)),s.markmap&&o.use(le),s.mermaid&&o.use(ce),C(e.playground)){const{presets:r=[],config:i={}}=e.playground;r.forEach(l=>{l==="ts"?o.use(j,ee(i.ts??{})):l==="vue"?o.use(j,oe(i.vue??{})):l==="unocss"?o.use(j,ae(i.unocss??{})):C(l)&&o.use(j,l)})}s.kotlinPlayground&&o.use(re),s.vuePlayground&&o.use(de),s.sandpack&&o.use(ye)},clientConfigFile:o=>on(o,e,s)}};export{F as CODE_DEMO_DEFAULT_SETTING,z as chartjs,B as echarts,W as flowchart,se as generateUnoURL,pe as getMermaidContent,ee as getTSPlaygroundPreset,Z as getURL,ae as getUnoPlaygroundPreset,oe as getVuePlaygroundPreset,re as kotlinPlayground,le as markmap,G as mdDemo,sn as mdEnhancePlugin,ce as mermaid,J as normalDemo,N as plantuml,j as playground,V as reactDemo,ye as sandpack,L as vueDemo,de as vuePlayground};
//# sourceMappingURL=index.js.map
